<!DOCTYPE html>
<html>
<head>
	<%= stylesheet_link_tag "home", media: "all" %>
	<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
	<title>Weather Wanderer</title>
</head>
<body>
  <%= render "shared/navbar" %>
	<main class="float d-flex justify-content-center text-center mt-3">
		<div id="particles-js"></div>
		<div class="mt-5">
			<img id="logo" style="height: 35vh" src="<%= image_path("logo.png") %>" alt="Weather Wanderer Logo">
			<p class="display-1 text-white fw-semibold mt-3">Weather Wanderer</p>
			<p class="h4 text-white pb-5 fw-light" >Your Global Weather Adventure</p>
			<a href="/map" data-turbo="false" class="btn btn-outline-light btn-lg mt-2">
				Explore Now
			</a>
		</div>
	</main>
  <footer class="d-flex position-absolute bottom-0 align-items-center text-white pe-4" style="right: 0">
    <p id="cloud-clicker-count" class="mb-3 h6" ><%= @click.total_clicks %></p>
    <i class="bi bi-info-circle text-light h6 ms-2 mb-3" 
      data-bs-toggle="tooltip"
      data-bs-placement="top" 
      title="Meet Cloudy Clicker!<br/>Click the cloud to increment the counter.<br/>This shows the total clicks from all users." 
      data-bs-html="true" 
      style="cursor: pointer;">
    </i>
  </footer>
  <%= render "shared/flash_message" %>
</body>
</html>
<!-- Floating particles -->
<script>
  // TODO: put into a controller

  //TODO: figure out if we still want this
  // function updateTime() {
  //   const now = new Date();

  //   // Format the date to user's local timezone
  //   const options = {
  //     hour: "numeric",
  //     minute: "numeric",
  //     second: "numeric",
  //     timeZoneName: "short"
  //   };

  //   const localTime = now.toLocaleString(undefined, options);
  //   document.getElementById("local-time").innerText = localTime;
  // }

  // setInterval(updateTime, 1000);
  // updateTime();

  // Cloud clicker
  document.getElementById("logo").addEventListener('click', function() {
    fetch("/clicks/increment", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "X-CSRF-Token": document.querySelector('meta[name="csrf-token"]').getAttribute('content')
      },
      credentials: "same-origin"
    })
    .then(response => response.json())
    .then(data => {
      document.getElementById("cloud-clicker-count").innerText = data.total_clicks;
    })
  });

  // Help tooltip initialization
  var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
  var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
    return new bootstrap.Tooltip(tooltipTriggerEl)
  })

  document.addEventListener("DOMContentLoaded", function() {
    particlesJS("particles-js", {
      particles: {
        number: {
          value: 100,
        },
        shape: {
          type: "circle",
        },
        opacity: {
          value: 0.5,
        },
        size: {
          value: 3,
        },
        move: {
          speed: 1,
        },
        line_linked: {
          enable: false
        }
      }
    });
  });
</script>
